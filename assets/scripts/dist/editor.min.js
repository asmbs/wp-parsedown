!function($, w, d) {
    $.parsedown = {
        aceObject: null,
        $wpEditor: null,
        options: {
            aceId: "ace-editor",
            aceOptions: {
                minLines: 24,
                maxLines: 1024
            }
        },
        replaceEditor: function(editorId) {
            var $aceContainer = $(d.createElement("pre")).attr("id", this.options.aceId), $wpEditor = ($("#wp-content-wrap"), 
            $("textarea#content")), $statusBar = $("#post-status-info"), currentContent = this.$wpEditor = $wpEditor.val();
            $aceContainer.insertBefore($statusBar);
            var _ace = this.aceObject = w.ace.edit(this.options.aceId);
            _ace.setOptions(this.options.aceOptions), _ace.getSession().setMode("ace/mode/markdown"), 
            _ace.setValue(currentContent);
        },
        syncContent: function(e) {
            var parsedown = e.data;
            parsedown.$wpEditor.val(parsedown.aceObject.getValue());
        }
    }, $(d).ready(function() {
        var parsedown = $.parsedown;
        $.parsedown.aceObject;
        parsedown.replaceEditor("ace-editor"), $("form#post").on("submit", parsedown, this.syncContent);
    });
}(jQuery, window, document);